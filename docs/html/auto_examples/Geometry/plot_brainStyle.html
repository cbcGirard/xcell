<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Stylized brain &mdash; xcell  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/xcell.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Logo" href="plot_xcellLogo.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #990000" >

          
          
          <a href="../../index.html">
            
              <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../intro.html">Purpose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#installing">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro.html#citation">Citation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Example applications</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#geometry">Geometry</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Geometry</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_xcellLogo.html">Logo</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Stylized brain</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#segment-mesh-and-visualize">Segment mesh and visualize</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/index.html">API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #990000" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">xcell</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Example applications</a></li>
          <li class="breadcrumb-item"><a href="index.html">Geometry</a></li>
      <li class="breadcrumb-item active">Stylized brain</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/auto_examples/Geometry/plot_brainStyle.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-geometry-plot-brainstyle-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="stylized-brain">
<span id="sphx-glr-auto-examples-geometry-plot-brainstyle-py"></span><h1>Stylized brain<a class="headerlink" href="#stylized-brain" title="Permalink to this heading">ÔÉÅ</a></h1>
<p>Multiresolution meshing from an existing surface mesh.</p>
<p>Original mesh, generated from MRI data, is available at <a class="reference external" href="https://3dprint.nih.gov/discover/3DPX-000320">https://3dprint.nih.gov/discover/3DPX-000320</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xcell</span>
<span class="kn">import</span> <span class="nn">pyvista</span> <span class="k">as</span> <span class="nn">pv</span>
<span class="kn">import</span> <span class="nn">tqdm</span>
<span class="kn">from</span> <span class="nn">vtk</span> <span class="kn">import</span> <span class="n">VTK_QUAD</span>

<span class="n">stl</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;full_oriented_simpler.stl&#39;</span><span class="p">)</span>

<span class="c1"># pv.set_jupyter_backend(None)</span>

<span class="n">pts</span> <span class="o">=</span> <span class="n">stl</span><span class="o">.</span><span class="n">points</span>
<span class="n">ax</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">bbox</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                  <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)))</span>
<span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">bbox</span><span class="p">))</span><span class="o">*</span><span class="mf">1.5</span>

<span class="n">mindepth</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">maxdepth</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">setup</span> <span class="o">=</span> <span class="n">xcell</span><span class="o">.</span><span class="n">Simulation</span><span class="p">(</span><span class="s1">&#39;brain&#39;</span><span class="p">,</span> <span class="n">xmax</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">bbox</span><span class="p">),</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1"># interpolate by bounds</span>
<span class="n">idealDepth</span> <span class="o">=</span> <span class="n">mindepth</span><span class="o">+</span><span class="p">(</span><span class="n">maxdepth</span><span class="o">-</span><span class="n">mindepth</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pts</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">bbox</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
<span class="n">metfun</span> <span class="o">=</span> <span class="n">xcell</span><span class="o">.</span><span class="n">generalMetric</span>

<span class="n">setup</span><span class="o">.</span><span class="n">makeAdaptiveGrid</span><span class="p">(</span><span class="n">refPts</span><span class="o">=</span><span class="n">pts</span><span class="p">,</span> <span class="n">maxdepth</span><span class="o">=</span><span class="n">idealDepth</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span>
    <span class="nb">int</span><span class="p">),</span> <span class="n">minl0Function</span><span class="o">=</span><span class="n">metfun</span><span class="p">,</span> <span class="n">coefs</span><span class="o">=</span><span class="mf">0.2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">idealDepth</span><span class="p">),</span>
    <span class="n">coarsen</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">setup</span><span class="o">.</span><span class="n">finalizeMesh</span><span class="p">()</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Make elements starting
Make elements: 147.527s [CPU], 147.546s [wall]
Finalize mesh starting
Finalize mesh: 5.7055s [CPU], 5.70583s [wall]
Calculate conductances starting
Calculate conductances: 13.0718s [CPU], 13.0729s [wall]
Renumber nodes starting
Renumber nodes: 9.81224s [CPU], 3.09812s [wall]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">adj</span> <span class="o">=</span> <span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">getElementAdjacencies</span><span class="p">()</span>
<span class="c1"># reg = xcell.io.Regions()</span>
<span class="c1"># stl.cell_data[&#39;sigma&#39;] = 1.</span>
<span class="c1"># reg[&#39;Conductors&#39;].append(stl)</span>

<span class="c1"># reg.assignSigma(setup.mesh, defaultSigma=0)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Calculating adjacency:   0%|          | 0/1551649 [00:00&lt;?, ?it/s]
Calculating adjacency:   0%|          | 1/1551649 [00:00&lt;175:36:34,  2.45it/s]
Calculating adjacency:   0%|          | 4626/1551649 [00:00&lt;02:08, 12007.97it/s]
Calculating adjacency:   1%|          | 9172/1551649 [00:00&lt;01:13, 21057.24it/s]
Calculating adjacency:   1%|          | 13527/1551649 [00:00&lt;00:56, 27325.70it/s]
Calculating adjacency:   1%|1         | 18068/1551649 [00:00&lt;00:47, 32475.46it/s]
Calculating adjacency:   1%|1         | 22595/1551649 [00:00&lt;00:42, 36174.20it/s]
Calculating adjacency:   2%|1         | 27153/1551649 [00:01&lt;00:39, 38918.46it/s]
Calculating adjacency:   2%|2         | 31693/1551649 [00:01&lt;00:37, 40825.42it/s]
Calculating adjacency:   2%|2         | 36105/1551649 [00:01&lt;00:36, 41473.47it/s]
Calculating adjacency:   3%|2         | 40481/1551649 [00:01&lt;00:36, 41627.70it/s]
Calculating adjacency:   3%|2         | 44817/1551649 [00:01&lt;00:35, 42136.12it/s]
Calculating adjacency:   3%|3         | 49143/1551649 [00:01&lt;00:35, 41814.29it/s]
Calculating adjacency:   3%|3         | 53403/1551649 [00:01&lt;00:36, 41540.69it/s]
Calculating adjacency:   4%|3         | 57612/1551649 [00:01&lt;00:36, 40837.28it/s]
Calculating adjacency:   4%|3         | 61843/1551649 [00:01&lt;00:36, 41264.56it/s]
Calculating adjacency:   4%|4         | 65999/1551649 [00:01&lt;00:35, 41319.03it/s]
Calculating adjacency:   5%|4         | 70189/1551649 [00:02&lt;00:35, 41488.06it/s]
Calculating adjacency:   5%|4         | 74353/1551649 [00:02&lt;00:35, 41402.94it/s]
Calculating adjacency:   5%|5         | 78504/1551649 [00:02&lt;00:35, 41372.52it/s]
Calculating adjacency:   5%|5         | 82649/1551649 [00:02&lt;00:35, 41279.41it/s]
Calculating adjacency:   6%|5         | 86782/1551649 [00:02&lt;00:35, 41231.15it/s]
Calculating adjacency:   6%|5         | 90909/1551649 [00:02&lt;00:35, 40974.03it/s]
Calculating adjacency:   6%|6         | 95010/1551649 [00:02&lt;00:35, 40848.13it/s]
Calculating adjacency:   6%|6         | 99097/1551649 [00:02&lt;00:35, 40716.39it/s]
Calculating adjacency:   7%|6         | 103170/1551649 [00:02&lt;00:35, 40506.34it/s]
Calculating adjacency:   7%|6         | 107222/1551649 [00:02&lt;00:35, 40191.99it/s]
Calculating adjacency:   7%|7         | 111243/1551649 [00:03&lt;00:36, 39949.92it/s]
Calculating adjacency:   7%|7         | 115239/1551649 [00:03&lt;00:36, 39648.85it/s]
Calculating adjacency:   8%|7         | 119205/1551649 [00:03&lt;00:36, 39413.48it/s]
Calculating adjacency:   8%|7         | 123147/1551649 [00:03&lt;00:36, 39294.99it/s]
Calculating adjacency:   8%|8         | 127077/1551649 [00:03&lt;00:36, 39118.74it/s]
Calculating adjacency:   8%|8         | 130990/1551649 [00:03&lt;00:36, 39011.64it/s]
Calculating adjacency:   9%|8         | 134892/1551649 [00:03&lt;00:36, 38787.70it/s]
Calculating adjacency:   9%|8         | 138793/1551649 [00:03&lt;00:36, 38851.87it/s]
Calculating adjacency:   9%|9         | 142679/1551649 [00:03&lt;00:36, 38517.21it/s]
Calculating adjacency:   9%|9         | 146532/1551649 [00:07&lt;06:33, 3571.77it/s]
Calculating adjacency:  10%|9         | 150422/1551649 [00:07&lt;04:45, 4906.86it/s]
Calculating adjacency:  10%|9         | 154502/1551649 [00:07&lt;03:27, 6745.37it/s]
Calculating adjacency:  10%|#         | 158586/1551649 [00:07&lt;02:33, 9069.98it/s]
Calculating adjacency:  10%|#         | 162539/1551649 [00:07&lt;01:57, 11773.40it/s]
Calculating adjacency:  11%|#         | 166484/1551649 [00:07&lt;01:33, 14887.69it/s]
Calculating adjacency:  11%|#         | 170430/1551649 [00:07&lt;01:15, 18290.54it/s]
Calculating adjacency:  11%|#1        | 174346/1551649 [00:07&lt;01:03, 21736.62it/s]
Calculating adjacency:  11%|#1        | 178198/1551649 [00:08&lt;00:55, 24929.65it/s]
Calculating adjacency:  12%|#1        | 182144/1551649 [00:08&lt;00:48, 28040.72it/s]
Calculating adjacency:  12%|#1        | 186040/1551649 [00:08&lt;00:44, 30597.73it/s]
Calculating adjacency:  12%|#2        | 190016/1551649 [00:08&lt;00:41, 32894.59it/s]
Calculating adjacency:  13%|#2        | 193983/1551649 [00:08&lt;00:39, 34679.98it/s]
Calculating adjacency:  13%|#2        | 197946/1551649 [00:08&lt;00:37, 36033.58it/s]
Calculating adjacency:  13%|#3        | 201885/1551649 [00:08&lt;00:36, 36804.45it/s]
Calculating adjacency:  13%|#3        | 205841/1551649 [00:08&lt;00:35, 37590.91it/s]
Calculating adjacency:  14%|#3        | 209804/1551649 [00:08&lt;00:35, 38180.77it/s]
Calculating adjacency:  14%|#3        | 213744/1551649 [00:08&lt;00:34, 38536.12it/s]
Calculating adjacency:  14%|#4        | 217684/1551649 [00:09&lt;00:34, 38790.06it/s]
Calculating adjacency:  14%|#4        | 221624/1551649 [00:09&lt;00:34, 38881.01it/s]
Calculating adjacency:  15%|#4        | 225653/1551649 [00:09&lt;00:33, 39297.98it/s]
Calculating adjacency:  15%|#4        | 229630/1551649 [00:09&lt;00:33, 39438.06it/s]
Calculating adjacency:  15%|#5        | 233596/1551649 [00:09&lt;00:33, 39348.12it/s]
Calculating adjacency:  15%|#5        | 237546/1551649 [00:09&lt;00:33, 39391.87it/s]
Calculating adjacency:  16%|#5        | 241496/1551649 [00:09&lt;00:33, 39232.33it/s]
Calculating adjacency:  16%|#5        | 245427/1551649 [00:09&lt;00:33, 39181.74it/s]
Calculating adjacency:  16%|#6        | 249365/1551649 [00:09&lt;00:33, 39239.90it/s]
Calculating adjacency:  16%|#6        | 253328/1551649 [00:09&lt;00:32, 39354.33it/s]
Calculating adjacency:  17%|#6        | 257267/1551649 [00:10&lt;00:33, 39166.55it/s]
Calculating adjacency:  17%|#6        | 261186/1551649 [00:10&lt;00:33, 39060.01it/s]
Calculating adjacency:  17%|#7        | 265128/1551649 [00:10&lt;00:32, 39164.68it/s]
Calculating adjacency:  17%|#7        | 269059/1551649 [00:10&lt;00:32, 39205.25it/s]
Calculating adjacency:  18%|#7        | 273013/1551649 [00:10&lt;00:32, 39303.23it/s]
Calculating adjacency:  18%|#7        | 276944/1551649 [00:10&lt;00:32, 39267.77it/s]
Calculating adjacency:  18%|#8        | 280872/1551649 [00:10&lt;00:32, 39097.04it/s]
Calculating adjacency:  18%|#8        | 284794/1551649 [00:10&lt;00:32, 39132.82it/s]
Calculating adjacency:  19%|#8        | 288744/1551649 [00:10&lt;00:32, 39242.21it/s]
Calculating adjacency:  19%|#8        | 292699/1551649 [00:10&lt;00:32, 39332.16it/s]
Calculating adjacency:  19%|#9        | 296633/1551649 [00:11&lt;00:31, 39322.58it/s]
Calculating adjacency:  19%|#9        | 300566/1551649 [00:11&lt;00:31, 39210.91it/s]
Calculating adjacency:  20%|#9        | 304488/1551649 [00:11&lt;00:31, 39168.81it/s]
Calculating adjacency:  20%|#9        | 308405/1551649 [00:11&lt;00:31, 39162.56it/s]
Calculating adjacency:  20%|##        | 312348/1551649 [00:11&lt;00:31, 39242.10it/s]
Calculating adjacency:  20%|##        | 316367/1551649 [00:11&lt;00:31, 39524.19it/s]
Calculating adjacency:  21%|##        | 320538/1551649 [00:11&lt;00:30, 40177.28it/s]
Calculating adjacency:  21%|##        | 324556/1551649 [00:11&lt;00:30, 40068.63it/s]
Calculating adjacency:  21%|##1       | 328564/1551649 [00:11&lt;00:30, 39828.34it/s]
Calculating adjacency:  21%|##1       | 332548/1551649 [00:11&lt;00:30, 39687.30it/s]
Calculating adjacency:  22%|##1       | 336518/1551649 [00:12&lt;00:30, 39570.38it/s]
Calculating adjacency:  22%|##1       | 340476/1551649 [00:12&lt;00:30, 39480.99it/s]
Calculating adjacency:  22%|##2       | 344425/1551649 [00:12&lt;00:30, 39354.62it/s]
Calculating adjacency:  22%|##2       | 348361/1551649 [00:12&lt;00:30, 39293.42it/s]
Calculating adjacency:  23%|##2       | 352733/1551649 [00:12&lt;00:29, 40611.09it/s]
Calculating adjacency:  23%|##3       | 357045/1551649 [00:12&lt;00:28, 41359.75it/s]
Calculating adjacency:  23%|##3       | 361192/1551649 [00:12&lt;00:28, 41389.38it/s]
Calculating adjacency:  24%|##3       | 365530/1551649 [00:12&lt;00:28, 41982.26it/s]
Calculating adjacency:  24%|##3       | 369729/1551649 [00:12&lt;00:28, 41888.14it/s]
Calculating adjacency:  24%|##4       | 373979/1551649 [00:12&lt;00:27, 42069.81it/s]
Calculating adjacency:  24%|##4       | 378211/1551649 [00:13&lt;00:27, 42141.91it/s]
Calculating adjacency:  25%|##4       | 382426/1551649 [00:13&lt;00:27, 42025.27it/s]
Calculating adjacency:  25%|##4       | 386629/1551649 [00:13&lt;00:27, 41793.41it/s]
Calculating adjacency:  25%|##5       | 390809/1551649 [00:13&lt;00:27, 41529.70it/s]
Calculating adjacency:  25%|##5       | 394963/1551649 [00:13&lt;00:28, 41070.88it/s]
Calculating adjacency:  26%|##5       | 399072/1551649 [00:13&lt;00:28, 40544.81it/s]
Calculating adjacency:  26%|##5       | 403129/1551649 [00:13&lt;00:28, 40057.11it/s]
Calculating adjacency:  26%|##6       | 407137/1551649 [00:13&lt;00:28, 39880.75it/s]
Calculating adjacency:  26%|##6       | 411127/1551649 [00:13&lt;00:28, 39823.72it/s]
Calculating adjacency:  27%|##6       | 415110/1551649 [00:14&lt;00:28, 39582.20it/s]
Calculating adjacency:  27%|##7       | 419069/1551649 [00:14&lt;00:28, 39484.04it/s]
Calculating adjacency:  27%|##7       | 423018/1551649 [00:14&lt;00:28, 39347.17it/s]
Calculating adjacency:  28%|##7       | 426954/1551649 [00:14&lt;00:28, 39350.40it/s]
Calculating adjacency:  28%|##7       | 430909/1551649 [00:14&lt;00:28, 39409.20it/s]
Calculating adjacency:  28%|##8       | 434851/1551649 [00:14&lt;00:28, 39402.06it/s]
Calculating adjacency:  28%|##8       | 438803/1551649 [00:14&lt;00:28, 39435.21it/s]
Calculating adjacency:  29%|##8       | 442747/1551649 [00:14&lt;00:28, 39229.42it/s]
Calculating adjacency:  29%|##8       | 446676/1551649 [00:14&lt;00:28, 39246.05it/s]
Calculating adjacency:  29%|##9       | 450601/1551649 [00:14&lt;00:28, 39204.26it/s]
Calculating adjacency:  29%|##9       | 454573/1551649 [00:15&lt;00:27, 39355.53it/s]
Calculating adjacency:  30%|##9       | 458595/1551649 [00:15&lt;00:27, 39611.71it/s]
Calculating adjacency:  30%|##9       | 462745/1551649 [00:15&lt;00:27, 40174.77it/s]
Calculating adjacency:  30%|###       | 466806/1551649 [00:15&lt;00:26, 40303.88it/s]
Calculating adjacency:  30%|###       | 470872/1551649 [00:15&lt;00:26, 40410.02it/s]
Calculating adjacency:  31%|###       | 474931/1551649 [00:15&lt;00:26, 40461.68it/s]
Calculating adjacency:  31%|###       | 478978/1551649 [00:15&lt;00:26, 40015.46it/s]
Calculating adjacency:  31%|###1      | 482981/1551649 [00:15&lt;00:26, 39812.74it/s]
Calculating adjacency:  31%|###1      | 486964/1551649 [00:15&lt;00:26, 39602.12it/s]
Calculating adjacency:  32%|###1      | 490925/1551649 [00:15&lt;00:27, 39252.78it/s]
Calculating adjacency:  32%|###1      | 494852/1551649 [00:16&lt;00:26, 39172.40it/s]
Calculating adjacency:  32%|###2      | 498800/1551649 [00:16&lt;00:26, 39262.93it/s]
Calculating adjacency:  32%|###2      | 502727/1551649 [00:16&lt;00:26, 39043.08it/s]
Calculating adjacency:  33%|###2      | 506632/1551649 [00:16&lt;00:26, 38942.84it/s]
Calculating adjacency:  33%|###2      | 510527/1551649 [00:16&lt;00:26, 38815.40it/s]
Calculating adjacency:  33%|###3      | 514409/1551649 [00:16&lt;00:26, 38673.43it/s]
Calculating adjacency:  33%|###3      | 518322/1551649 [00:16&lt;00:26, 38808.36it/s]
Calculating adjacency:  34%|###3      | 522300/1551649 [00:16&lt;00:26, 39097.60it/s]
Calculating adjacency:  34%|###3      | 526268/1551649 [00:16&lt;00:26, 39270.74it/s]
Calculating adjacency:  34%|###4      | 530254/1551649 [00:16&lt;00:25, 39446.17it/s]
Calculating adjacency:  34%|###4      | 534207/1551649 [00:17&lt;00:25, 39469.62it/s]
Calculating adjacency:  35%|###4      | 538172/1551649 [00:17&lt;00:25, 39521.26it/s]
Calculating adjacency:  35%|###4      | 542146/1551649 [00:17&lt;00:25, 39586.23it/s]
Calculating adjacency:  35%|###5      | 546116/1551649 [00:17&lt;00:25, 39617.57it/s]
Calculating adjacency:  35%|###5      | 550078/1551649 [00:17&lt;00:25, 39589.11it/s]
Calculating adjacency:  36%|###5      | 554037/1551649 [00:17&lt;00:25, 39583.08it/s]
Calculating adjacency:  36%|###5      | 558003/1551649 [00:17&lt;00:25, 39603.40it/s]
Calculating adjacency:  36%|###6      | 562035/1551649 [00:17&lt;00:24, 39815.71it/s]
Calculating adjacency:  36%|###6      | 566093/1551649 [00:17&lt;00:24, 40042.61it/s]
Calculating adjacency:  37%|###6      | 570134/1551649 [00:17&lt;00:24, 40149.73it/s]
Calculating adjacency:  37%|###7      | 574149/1551649 [00:18&lt;00:24, 39866.84it/s]
Calculating adjacency:  37%|###7      | 578141/1551649 [00:18&lt;00:24, 39880.62it/s]
Calculating adjacency:  38%|###7      | 582130/1551649 [00:18&lt;00:24, 39694.44it/s]
Calculating adjacency:  38%|###7      | 586100/1551649 [00:18&lt;00:24, 39689.48it/s]
Calculating adjacency:  38%|###8      | 590070/1551649 [00:18&lt;00:24, 39673.95it/s]
Calculating adjacency:  38%|###8      | 594038/1551649 [00:18&lt;00:24, 39662.82it/s]
Calculating adjacency:  39%|###8      | 598009/1551649 [00:18&lt;00:24, 39676.07it/s]
Calculating adjacency:  39%|###8      | 601977/1551649 [00:18&lt;00:23, 39646.38it/s]
Calculating adjacency:  39%|###9      | 605992/1551649 [00:18&lt;00:23, 39794.53it/s]
Calculating adjacency:  39%|###9      | 609972/1551649 [00:18&lt;00:23, 39644.85it/s]
Calculating adjacency:  40%|###9      | 613937/1551649 [00:19&lt;00:23, 39543.22it/s]
Calculating adjacency:  40%|###9      | 617892/1551649 [00:19&lt;00:23, 39469.67it/s]
Calculating adjacency:  40%|####      | 621852/1551649 [00:19&lt;00:23, 39507.85it/s]
Calculating adjacency:  40%|####      | 625850/1551649 [00:19&lt;00:23, 39646.73it/s]
Calculating adjacency:  41%|####      | 629815/1551649 [00:19&lt;00:23, 39637.42it/s]
Calculating adjacency:  41%|####      | 633789/1551649 [00:19&lt;00:23, 39666.25it/s]
Calculating adjacency:  41%|####1     | 637763/1551649 [00:19&lt;00:23, 39687.97it/s]
Calculating adjacency:  41%|####1     | 641732/1551649 [00:19&lt;00:22, 39637.66it/s]
Calculating adjacency:  42%|####1     | 645696/1551649 [00:19&lt;00:22, 39637.92it/s]
Calculating adjacency:  42%|####1     | 649681/1551649 [00:19&lt;00:22, 39698.71it/s]
Calculating adjacency:  42%|####2     | 653651/1551649 [00:20&lt;00:22, 39596.49it/s]
Calculating adjacency:  42%|####2     | 657611/1551649 [00:20&lt;00:22, 39590.63it/s]
Calculating adjacency:  43%|####2     | 661781/1551649 [00:20&lt;00:22, 40220.83it/s]
Calculating adjacency:  43%|####2     | 666122/1551649 [00:20&lt;00:21, 41174.29it/s]
Calculating adjacency:  43%|####3     | 670370/1551649 [00:20&lt;00:21, 41564.82it/s]
Calculating adjacency:  43%|####3     | 674569/1551649 [00:20&lt;00:21, 41689.74it/s]
Calculating adjacency:  44%|####3     | 678745/1551649 [00:20&lt;00:20, 41708.37it/s]
Calculating adjacency:  44%|####4     | 682916/1551649 [00:20&lt;00:20, 41694.59it/s]
Calculating adjacency:  44%|####4     | 687121/1551649 [00:20&lt;00:20, 41799.08it/s]
Calculating adjacency:  45%|####4     | 691301/1551649 [00:20&lt;00:20, 41062.01it/s]
Calculating adjacency:  45%|####4     | 695411/1551649 [00:21&lt;00:20, 40872.07it/s]
Calculating adjacency:  45%|####5     | 699501/1551649 [00:21&lt;00:21, 40456.97it/s]
Calculating adjacency:  45%|####5     | 703549/1551649 [00:21&lt;00:21, 40116.29it/s]
Calculating adjacency:  46%|####5     | 707563/1551649 [00:21&lt;00:21, 39831.39it/s]
Calculating adjacency:  46%|####5     | 711548/1551649 [00:21&lt;00:21, 39742.37it/s]
Calculating adjacency:  46%|####6     | 715523/1551649 [00:21&lt;00:21, 39696.45it/s]
Calculating adjacency:  46%|####6     | 719494/1551649 [00:21&lt;00:21, 39555.32it/s]
Calculating adjacency:  47%|####6     | 723450/1551649 [00:21&lt;00:21, 39419.10it/s]
Calculating adjacency:  47%|####6     | 727393/1551649 [00:21&lt;00:20, 39395.05it/s]
Calculating adjacency:  47%|####7     | 731342/1551649 [00:21&lt;00:20, 39422.20it/s]
Calculating adjacency:  47%|####7     | 735306/1551649 [00:22&lt;00:20, 39483.38it/s]
Calculating adjacency:  48%|####7     | 739255/1551649 [00:22&lt;00:20, 39360.59it/s]
Calculating adjacency:  48%|####7     | 743192/1551649 [00:22&lt;00:20, 39357.19it/s]
Calculating adjacency:  48%|####8     | 747171/1551649 [00:22&lt;00:20, 39485.53it/s]
Calculating adjacency:  48%|####8     | 751200/1551649 [00:22&lt;00:20, 39724.55it/s]
Calculating adjacency:  49%|####8     | 755240/1551649 [00:22&lt;00:19, 39926.47it/s]
Calculating adjacency:  49%|####8     | 759233/1551649 [00:22&lt;00:19, 39847.32it/s]
Calculating adjacency:  49%|####9     | 763218/1551649 [00:26&lt;04:14, 3094.16it/s]
Calculating adjacency:  49%|####9     | 767515/1551649 [00:26&lt;02:59, 4375.62it/s]
Calculating adjacency:  50%|####9     | 771909/1551649 [00:26&lt;02:07, 6112.23it/s]
Calculating adjacency:  50%|#####     | 776088/1551649 [00:27&lt;01:34, 8217.30it/s]
Calculating adjacency:  50%|#####     | 780374/1551649 [00:27&lt;01:10, 10910.29it/s]
Calculating adjacency:  51%|#####     | 784581/1551649 [00:27&lt;00:54, 14021.89it/s]
Calculating adjacency:  51%|#####     | 788765/1551649 [00:27&lt;00:43, 17496.80it/s]
Calculating adjacency:  51%|#####1    | 793094/1551649 [00:27&lt;00:35, 21402.42it/s]
Calculating adjacency:  51%|#####1    | 797291/1551649 [00:27&lt;00:30, 25059.70it/s]
Calculating adjacency:  52%|#####1    | 801608/1551649 [00:27&lt;00:26, 28728.65it/s]
Calculating adjacency:  52%|#####1    | 805820/1551649 [00:27&lt;00:23, 31733.40it/s]
Calculating adjacency:  52%|#####2    | 810146/1551649 [00:27&lt;00:21, 34531.16it/s]
Calculating adjacency:  52%|#####2    | 814389/1551649 [00:27&lt;00:20, 36434.57it/s]
Calculating adjacency:  53%|#####2    | 818615/1551649 [00:28&lt;00:19, 37567.72it/s]
Calculating adjacency:  53%|#####3    | 822789/1551649 [00:28&lt;00:18, 38476.10it/s]
Calculating adjacency:  53%|#####3    | 826936/1551649 [00:28&lt;00:18, 39098.00it/s]
Calculating adjacency:  54%|#####3    | 831155/1551649 [00:28&lt;00:18, 39979.17it/s]
Calculating adjacency:  54%|#####3    | 835307/1551649 [00:28&lt;00:17, 40002.28it/s]
Calculating adjacency:  54%|#####4    | 839415/1551649 [00:28&lt;00:17, 39966.42it/s]
Calculating adjacency:  54%|#####4    | 843487/1551649 [00:28&lt;00:17, 39694.60it/s]
Calculating adjacency:  55%|#####4    | 847510/1551649 [00:28&lt;00:17, 39629.33it/s]
Calculating adjacency:  55%|#####4    | 851527/1551649 [00:28&lt;00:17, 39785.81it/s]
Calculating adjacency:  55%|#####5    | 855532/1551649 [00:28&lt;00:17, 39798.64it/s]
Calculating adjacency:  55%|#####5    | 859531/1551649 [00:29&lt;00:17, 39646.52it/s]
Calculating adjacency:  56%|#####5    | 863509/1551649 [00:29&lt;00:17, 39596.46it/s]
Calculating adjacency:  56%|#####5    | 867494/1551649 [00:29&lt;00:17, 39670.94it/s]
Calculating adjacency:  56%|#####6    | 871468/1551649 [00:29&lt;00:17, 39675.48it/s]
Calculating adjacency:  56%|#####6    | 875476/1551649 [00:29&lt;00:16, 39795.47it/s]
Calculating adjacency:  57%|#####6    | 879568/1551649 [00:29&lt;00:16, 40129.07it/s]
Calculating adjacency:  57%|#####6    | 883584/1551649 [00:29&lt;00:16, 40114.64it/s]
Calculating adjacency:  57%|#####7    | 887598/1551649 [00:29&lt;00:16, 39663.23it/s]
Calculating adjacency:  57%|#####7    | 891567/1551649 [00:29&lt;00:16, 39620.20it/s]
Calculating adjacency:  58%|#####7    | 895531/1551649 [00:29&lt;00:16, 39523.44it/s]
Calculating adjacency:  58%|#####7    | 899502/1551649 [00:30&lt;00:16, 39576.48it/s]
Calculating adjacency:  58%|#####8    | 903461/1551649 [00:30&lt;00:16, 39352.97it/s]
Calculating adjacency:  58%|#####8    | 907429/1551649 [00:30&lt;00:16, 39449.98it/s]
Calculating adjacency:  59%|#####8    | 911375/1551649 [00:30&lt;00:16, 39416.64it/s]
Calculating adjacency:  59%|#####8    | 915330/1551649 [00:30&lt;00:16, 39454.97it/s]
Calculating adjacency:  59%|#####9    | 919299/1551649 [00:30&lt;00:15, 39524.20it/s]
Calculating adjacency:  60%|#####9    | 923252/1551649 [00:30&lt;00:15, 39376.94it/s]
Calculating adjacency:  60%|#####9    | 927210/1551649 [00:30&lt;00:15, 39436.69it/s]
Calculating adjacency:  60%|######    | 931180/1551649 [00:30&lt;00:15, 39514.05it/s]
Calculating adjacency:  60%|######    | 935140/1551649 [00:30&lt;00:15, 39539.60it/s]
Calculating adjacency:  61%|######    | 939095/1551649 [00:31&lt;00:15, 39514.73it/s]
Calculating adjacency:  61%|######    | 943047/1551649 [00:31&lt;00:15, 39340.02it/s]
Calculating adjacency:  61%|######1   | 946986/1551649 [00:31&lt;00:15, 39354.68it/s]
Calculating adjacency:  61%|######1   | 950925/1551649 [00:31&lt;00:15, 39362.37it/s]
Calculating adjacency:  62%|######1   | 954862/1551649 [00:31&lt;00:15, 39290.35it/s]
Calculating adjacency:  62%|######1   | 958830/1551649 [00:31&lt;00:15, 39405.02it/s]
Calculating adjacency:  62%|######2   | 962771/1551649 [00:31&lt;00:15, 39123.03it/s]
Calculating adjacency:  62%|######2   | 966777/1551649 [00:31&lt;00:14, 39401.43it/s]
Calculating adjacency:  63%|######2   | 970776/1551649 [00:31&lt;00:14, 39575.80it/s]
Calculating adjacency:  63%|######2   | 974864/1551649 [00:31&lt;00:14, 39964.62it/s]
Calculating adjacency:  63%|######3   | 979061/1551649 [00:32&lt;00:14, 40563.84it/s]
Calculating adjacency:  63%|######3   | 983186/1551649 [00:32&lt;00:13, 40768.27it/s]
Calculating adjacency:  64%|######3   | 987264/1551649 [00:32&lt;00:13, 40730.76it/s]
Calculating adjacency:  64%|######3   | 991338/1551649 [00:32&lt;00:13, 40697.62it/s]
Calculating adjacency:  64%|######4   | 995469/1551649 [00:32&lt;00:13, 40880.25it/s]
Calculating adjacency:  64%|######4   | 999598/1551649 [00:32&lt;00:13, 41002.54it/s]
Calculating adjacency:  65%|######4   | 1003699/1551649 [00:32&lt;00:13, 40320.62it/s]
Calculating adjacency:  65%|######4   | 1007734/1551649 [00:32&lt;00:13, 40105.46it/s]
Calculating adjacency:  65%|######5   | 1011747/1551649 [00:32&lt;00:13, 39838.31it/s]
Calculating adjacency:  65%|######5   | 1015733/1551649 [00:32&lt;00:13, 39662.51it/s]
Calculating adjacency:  66%|######5   | 1019701/1551649 [00:33&lt;00:13, 39555.92it/s]
Calculating adjacency:  66%|######5   | 1023658/1551649 [00:33&lt;00:13, 39557.45it/s]
Calculating adjacency:  66%|######6   | 1027615/1551649 [00:33&lt;00:13, 39489.28it/s]
Calculating adjacency:  66%|######6   | 1031570/1551649 [00:33&lt;00:13, 39506.82it/s]
Calculating adjacency:  67%|######6   | 1035541/1551649 [00:33&lt;00:13, 39564.99it/s]
Calculating adjacency:  67%|######6   | 1039503/1551649 [00:33&lt;00:12, 39581.06it/s]
Calculating adjacency:  67%|######7   | 1043462/1551649 [00:33&lt;00:12, 39323.18it/s]
Calculating adjacency:  68%|######7   | 1047440/1551649 [00:33&lt;00:12, 39457.28it/s]
Calculating adjacency:  68%|######7   | 1051642/1551649 [00:33&lt;00:12, 40221.04it/s]
Calculating adjacency:  68%|######8   | 1056045/1551649 [00:33&lt;00:11, 41359.28it/s]
Calculating adjacency:  68%|######8   | 1060182/1551649 [00:34&lt;00:12, 40641.16it/s]
Calculating adjacency:  69%|######8   | 1064250/1551649 [00:34&lt;00:12, 40165.74it/s]
Calculating adjacency:  69%|######8   | 1068270/1551649 [00:34&lt;00:12, 39799.30it/s]
Calculating adjacency:  69%|######9   | 1072253/1551649 [00:34&lt;00:12, 39630.84it/s]
Calculating adjacency:  69%|######9   | 1076218/1551649 [00:34&lt;00:12, 39587.41it/s]
Calculating adjacency:  70%|######9   | 1080178/1551649 [00:34&lt;00:11, 39455.81it/s]
Calculating adjacency:  70%|######9   | 1084125/1551649 [00:34&lt;00:11, 39149.02it/s]
Calculating adjacency:  70%|#######   | 1088219/1551649 [00:34&lt;00:11, 39678.82it/s]
Calculating adjacency:  70%|#######   | 1092627/1551649 [00:34&lt;00:11, 40986.38it/s]
Calculating adjacency:  71%|#######   | 1096938/1551649 [00:34&lt;00:10, 41616.84it/s]
Calculating adjacency:  71%|#######   | 1101132/1551649 [00:35&lt;00:10, 41712.16it/s]
Calculating adjacency:  71%|#######1  | 1105383/1551649 [00:35&lt;00:10, 41949.12it/s]
Calculating adjacency:  72%|#######1  | 1109579/1551649 [00:35&lt;00:10, 41869.06it/s]
Calculating adjacency:  72%|#######1  | 1113767/1551649 [00:35&lt;00:10, 41805.27it/s]
Calculating adjacency:  72%|#######2  | 1117949/1551649 [00:35&lt;00:10, 41630.36it/s]
Calculating adjacency:  72%|#######2  | 1122113/1551649 [00:35&lt;00:10, 40742.40it/s]
Calculating adjacency:  73%|#######2  | 1126192/1551649 [00:35&lt;00:10, 40072.07it/s]
Calculating adjacency:  73%|#######2  | 1130204/1551649 [00:35&lt;00:10, 39942.16it/s]
Calculating adjacency:  73%|#######3  | 1134201/1551649 [00:35&lt;00:10, 39721.28it/s]
Calculating adjacency:  73%|#######3  | 1138175/1551649 [00:36&lt;00:10, 39646.03it/s]
Calculating adjacency:  74%|#######3  | 1142141/1551649 [00:36&lt;00:10, 39492.78it/s]
Calculating adjacency:  74%|#######3  | 1146092/1551649 [00:36&lt;00:10, 39393.99it/s]
Calculating adjacency:  74%|#######4  | 1150032/1551649 [00:36&lt;00:10, 39369.02it/s]
Calculating adjacency:  74%|#######4  | 1153970/1551649 [00:36&lt;00:10, 39316.73it/s]
Calculating adjacency:  75%|#######4  | 1157916/1551649 [00:36&lt;00:10, 39358.96it/s]
Calculating adjacency:  75%|#######4  | 1161886/1551649 [00:36&lt;00:09, 39458.70it/s]
Calculating adjacency:  75%|#######5  | 1165833/1551649 [00:36&lt;00:09, 39365.78it/s]
Calculating adjacency:  75%|#######5  | 1169770/1551649 [00:36&lt;00:09, 39229.72it/s]
Calculating adjacency:  76%|#######5  | 1173732/1551649 [00:36&lt;00:09, 39343.71it/s]
Calculating adjacency:  76%|#######5  | 1177687/1551649 [00:37&lt;00:09, 39402.43it/s]
Calculating adjacency:  76%|#######6  | 1181651/1551649 [00:37&lt;00:09, 39471.02it/s]
Calculating adjacency:  76%|#######6  | 1185687/1551649 [00:37&lt;00:09, 39735.28it/s]
Calculating adjacency:  77%|#######6  | 1189799/1551649 [00:37&lt;00:09, 40149.42it/s]
Calculating adjacency:  77%|#######6  | 1193815/1551649 [00:37&lt;00:08, 39978.26it/s]
Calculating adjacency:  77%|#######7  | 1197814/1551649 [00:37&lt;00:08, 39586.24it/s]
Calculating adjacency:  77%|#######7  | 1201774/1551649 [00:37&lt;00:08, 39510.37it/s]
Calculating adjacency:  78%|#######7  | 1205726/1551649 [00:37&lt;00:08, 39408.26it/s]
Calculating adjacency:  78%|#######7  | 1209684/1551649 [00:37&lt;00:08, 39459.18it/s]
Calculating adjacency:  78%|#######8  | 1213652/1551649 [00:37&lt;00:08, 39523.43it/s]
Calculating adjacency:  78%|#######8  | 1217605/1551649 [00:38&lt;00:08, 39470.33it/s]
Calculating adjacency:  79%|#######8  | 1221553/1551649 [00:38&lt;00:08, 39444.62it/s]
Calculating adjacency:  79%|#######8  | 1225525/1551649 [00:38&lt;00:08, 39525.47it/s]
Calculating adjacency:  79%|#######9  | 1229496/1551649 [00:38&lt;00:08, 39580.47it/s]
Calculating adjacency:  79%|#######9  | 1233455/1551649 [00:38&lt;00:08, 39501.80it/s]
Calculating adjacency:  80%|#######9  | 1237406/1551649 [00:38&lt;00:07, 39382.77it/s]
Calculating adjacency:  80%|########  | 1241345/1551649 [00:38&lt;00:07, 39200.58it/s]
Calculating adjacency:  80%|########  | 1245266/1551649 [00:38&lt;00:07, 39032.49it/s]
Calculating adjacency:  81%|########  | 1249218/1551649 [00:38&lt;00:07, 39174.85it/s]
Calculating adjacency:  81%|########  | 1253172/1551649 [00:38&lt;00:07, 39281.13it/s]
Calculating adjacency:  81%|########1 | 1257136/1551649 [00:39&lt;00:07, 39387.62it/s]
Calculating adjacency:  81%|########1 | 1261107/1551649 [00:39&lt;00:07, 39481.20it/s]
Calculating adjacency:  82%|########1 | 1265056/1551649 [00:39&lt;00:07, 39477.84it/s]
Calculating adjacency:  82%|########1 | 1269004/1551649 [00:39&lt;00:07, 39416.53it/s]
Calculating adjacency:  82%|########2 | 1272951/1551649 [00:39&lt;00:07, 39430.78it/s]
Calculating adjacency:  82%|########2 | 1276895/1551649 [00:39&lt;00:06, 39285.75it/s]
Calculating adjacency:  83%|########2 | 1280824/1551649 [00:39&lt;00:06, 39249.88it/s]
Calculating adjacency:  83%|########2 | 1284750/1551649 [00:39&lt;00:06, 39179.57it/s]
Calculating adjacency:  83%|########3 | 1288755/1551649 [00:39&lt;00:06, 39439.27it/s]
Calculating adjacency:  83%|########3 | 1292854/1551649 [00:39&lt;00:06, 39900.88it/s]
Calculating adjacency:  84%|########3 | 1296884/1551649 [00:40&lt;00:06, 40018.47it/s]
Calculating adjacency:  84%|########3 | 1300954/1551649 [00:40&lt;00:06, 40221.38it/s]
Calculating adjacency:  84%|########4 | 1304977/1551649 [00:40&lt;00:06, 39849.86it/s]
Calculating adjacency:  84%|########4 | 1308963/1551649 [00:40&lt;00:06, 39663.89it/s]
Calculating adjacency:  85%|########4 | 1312931/1551649 [00:40&lt;00:06, 39527.11it/s]
Calculating adjacency:  85%|########4 | 1316885/1551649 [00:40&lt;00:05, 39448.36it/s]
Calculating adjacency:  85%|########5 | 1320831/1551649 [00:40&lt;00:05, 39227.43it/s]
Calculating adjacency:  85%|########5 | 1324783/1551649 [00:40&lt;00:05, 39312.60it/s]
Calculating adjacency:  86%|########5 | 1328719/1551649 [00:40&lt;00:05, 39325.57it/s]
Calculating adjacency:  86%|########5 | 1332652/1551649 [00:40&lt;00:05, 39262.55it/s]
Calculating adjacency:  86%|########6 | 1336617/1551649 [00:41&lt;00:05, 39328.05it/s]
Calculating adjacency:  86%|########6 | 1340596/1551649 [00:41&lt;00:05, 39464.11it/s]
Calculating adjacency:  87%|########6 | 1344576/1551649 [00:41&lt;00:05, 39562.35it/s]
Calculating adjacency:  87%|########6 | 1348555/1551649 [00:41&lt;00:05, 39627.75it/s]
Calculating adjacency:  87%|########7 | 1352518/1551649 [00:41&lt;00:05, 39558.53it/s]
Calculating adjacency:  87%|########7 | 1356474/1551649 [00:41&lt;00:04, 39445.26it/s]
Calculating adjacency:  88%|########7 | 1360467/1551649 [00:41&lt;00:04, 39589.52it/s]
Calculating adjacency:  88%|########7 | 1364427/1551649 [00:41&lt;00:04, 38297.64it/s]
Calculating adjacency:  88%|########8 | 1368266/1551649 [00:41&lt;00:04, 37900.16it/s]
Calculating adjacency:  88%|########8 | 1372109/1551649 [00:41&lt;00:04, 38054.00it/s]
Calculating adjacency:  89%|########8 | 1375920/1551649 [00:42&lt;00:04, 37876.22it/s]
Calculating adjacency:  89%|########8 | 1379711/1551649 [00:42&lt;00:04, 36972.05it/s]
Calculating adjacency:  89%|########9 | 1383415/1551649 [00:42&lt;00:04, 36472.78it/s]
Calculating adjacency:  89%|########9 | 1387067/1551649 [00:42&lt;00:04, 35915.42it/s]
Calculating adjacency:  90%|########9 | 1390662/1551649 [00:42&lt;00:04, 35530.84it/s]
Calculating adjacency:  90%|########9 | 1394218/1551649 [00:42&lt;00:04, 35230.61it/s]
Calculating adjacency:  90%|######### | 1397795/1551649 [00:42&lt;00:04, 35385.29it/s]
Calculating adjacency:  90%|######### | 1401574/1551649 [00:42&lt;00:04, 36090.42it/s]
Calculating adjacency:  91%|######### | 1405350/1551649 [00:42&lt;00:03, 36582.10it/s]
Calculating adjacency:  91%|######### | 1409150/1551649 [00:42&lt;00:03, 37001.65it/s]
Calculating adjacency:  91%|#########1| 1412853/1551649 [00:43&lt;00:03, 36160.27it/s]
Calculating adjacency:  91%|#########1| 1416475/1551649 [00:43&lt;00:03, 36020.02it/s]
Calculating adjacency:  92%|#########1| 1420180/1551649 [00:43&lt;00:03, 36319.68it/s]
Calculating adjacency:  92%|#########1| 1423942/1551649 [00:43&lt;00:03, 36704.05it/s]
Calculating adjacency:  92%|#########2| 1427927/1551649 [00:43&lt;00:03, 37639.18it/s]
Calculating adjacency:  92%|#########2| 1432083/1551649 [00:43&lt;00:03, 38805.83it/s]
Calculating adjacency:  93%|#########2| 1436307/1551649 [00:43&lt;00:02, 39829.09it/s]
Calculating adjacency:  93%|#########2| 1440602/1551649 [00:43&lt;00:02, 40760.41it/s]
Calculating adjacency:  93%|#########3| 1444821/1551649 [00:43&lt;00:02, 41172.86it/s]
Calculating adjacency:  93%|#########3| 1449156/1551649 [00:44&lt;00:02, 41822.77it/s]
Calculating adjacency:  94%|#########3| 1453340/1551649 [00:44&lt;00:02, 41400.52it/s]
Calculating adjacency:  94%|#########3| 1457482/1551649 [00:44&lt;00:02, 40247.73it/s]
Calculating adjacency:  94%|#########4| 1461515/1551649 [00:44&lt;00:02, 39484.00it/s]
Calculating adjacency:  94%|#########4| 1465471/1551649 [00:44&lt;00:02, 39228.62it/s]
Calculating adjacency:  95%|#########4| 1469399/1551649 [00:44&lt;00:02, 39154.59it/s]
Calculating adjacency:  95%|#########4| 1473326/1551649 [00:44&lt;00:01, 39186.78it/s]
Calculating adjacency:  95%|#########5| 1477247/1551649 [00:44&lt;00:01, 38962.65it/s]
Calculating adjacency:  95%|#########5| 1481197/1551649 [00:44&lt;00:01, 39120.45it/s]
Calculating adjacency:  96%|#########5| 1485136/1551649 [00:44&lt;00:01, 39197.76it/s]
Calculating adjacency:  96%|#########5| 1489057/1551649 [00:45&lt;00:01, 39127.12it/s]
Calculating adjacency:  96%|#########6| 1492971/1551649 [00:49&lt;00:21, 2669.73it/s]
Calculating adjacency:  96%|#########6| 1496914/1551649 [00:49&lt;00:14, 3707.59it/s]
Calculating adjacency:  97%|#########6| 1500851/1551649 [00:49&lt;00:09, 5090.19it/s]
Calculating adjacency:  97%|#########6| 1504795/1551649 [00:50&lt;00:06, 6892.77it/s]
Calculating adjacency:  97%|#########7| 1508783/1551649 [00:50&lt;00:04, 9193.18it/s]
Calculating adjacency:  97%|#########7| 1512723/1551649 [00:50&lt;00:03, 11929.79it/s]
Calculating adjacency:  98%|#########7| 1516639/1551649 [00:50&lt;00:02, 15049.90it/s]
Calculating adjacency:  98%|#########8| 1520659/1551649 [00:50&lt;00:01, 18587.69it/s]
Calculating adjacency:  98%|#########8| 1524622/1551649 [00:50&lt;00:01, 22107.92it/s]
Calculating adjacency:  99%|#########8| 1528549/1551649 [00:50&lt;00:00, 25418.35it/s]
Calculating adjacency:  99%|#########8| 1532454/1551649 [00:50&lt;00:00, 28258.72it/s]
Calculating adjacency:  99%|#########9| 1536370/1551649 [00:50&lt;00:00, 30821.49it/s]
Calculating adjacency:  99%|#########9| 1540365/1551649 [00:50&lt;00:00, 33116.74it/s]
Calculating adjacency: 100%|#########9| 1544295/1551649 [00:51&lt;00:00, 34748.52it/s]
Calculating adjacency: 100%|#########9| 1548358/1551649 [00:51&lt;00:00, 36359.91it/s]
Calculating adjacency: 100%|##########| 1551649/1551649 [00:51&lt;00:00, 30316.59it/s]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">xmesh</span> <span class="o">=</span> <span class="n">xcell</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">toVTK</span><span class="p">(</span><span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="p">)</span>


<span class="n">xmesh</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;xmesh</span><span class="si">%d%d</span><span class="s1">.vtk&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mindepth</span><span class="p">,</span> <span class="n">maxdepth</span><span class="p">))</span>
<span class="n">inside</span> <span class="o">=</span> <span class="n">xmesh</span><span class="o">.</span><span class="n">cell_centers</span><span class="p">()</span><span class="o">.</span><span class="n">select_enclosed_points</span><span class="p">(</span><span class="n">stl</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">)</span>


<span class="k">for</span> <span class="n">el</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">elements</span><span class="p">,</span> <span class="n">inside</span><span class="p">[</span><span class="s1">&#39;SelectedPoints&#39;</span><span class="p">]):</span>
    <span class="n">el</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">s</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">okfaces</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">quadorders</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                       <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>

<span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="o">.</span><span class="n">trange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">elements</span><span class="p">),</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Checking faces&#39;</span><span class="p">):</span>
    <span class="n">el</span> <span class="o">=</span> <span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">el</span><span class="o">.</span><span class="n">sigma</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="n">adj</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">neighbor</span> <span class="o">=</span> <span class="n">neighbors</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">nei</span> <span class="ow">in</span> <span class="n">neighbor</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">nei</span><span class="o">.</span><span class="n">sigma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">nei</span><span class="o">.</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="n">el</span><span class="o">.</span><span class="n">depth</span><span class="p">:</span>

                        <span class="n">otherFaceInd</span> <span class="o">=</span> <span class="n">jj</span><span class="o">+</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">jj</span>
                        <span class="n">inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">nei</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">quadorders</span><span class="p">[</span><span class="n">otherFaceInd</span><span class="p">]])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">inds</span> <span class="o">=</span> <span class="n">el</span><span class="o">.</span><span class="n">vertices</span><span class="p">[</span><span class="n">quadorders</span><span class="p">[</span><span class="n">jj</span><span class="p">]]</span>

                    <span class="n">globalind</span> <span class="o">=</span> <span class="p">[</span><span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">inverseIdxMap</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">inds</span><span class="p">]</span>
                    <span class="n">okfaces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">globalind</span><span class="p">)</span>


<span class="n">fc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">okfaces</span><span class="p">)</span>

<span class="n">usedNodes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">fc</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>
<span class="n">revNodes</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">ii</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">usedNodes</span><span class="p">):</span>
    <span class="n">revNodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ii</span>

<span class="n">newpts</span> <span class="o">=</span> <span class="n">setup</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">nodeCoords</span><span class="p">[</span><span class="n">usedNodes</span><span class="p">]</span>

<span class="n">newFaces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">revNodes</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">fc</span><span class="o">.</span><span class="n">ravel</span><span class="p">()])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">fc</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">cells</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
    <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">newFaces</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">),</span> <span class="n">newFaces</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">uint64</span><span class="p">)))</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
<span class="n">cellTypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">VTK_QUAD</span><span class="p">]</span><span class="o">*</span><span class="n">newFaces</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">qmesh</span> <span class="o">=</span> <span class="n">pv</span><span class="o">.</span><span class="n">UnstructuredGrid</span><span class="p">(</span><span class="n">cells</span><span class="p">,</span> <span class="n">cellTypes</span><span class="p">,</span> <span class="n">newpts</span><span class="p">)</span>
<span class="n">qmesh</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;quad.vtk&#39;</span><span class="p">)</span>

<span class="n">qg</span> <span class="o">=</span> <span class="n">qmesh</span><span class="o">.</span><span class="n">compute_cell_sizes</span><span class="p">(</span><span class="n">length</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">volume</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">qg</span><span class="o">.</span><span class="n">set_active_scalars</span><span class="p">(</span><span class="s1">&#39;Area&#39;</span><span class="p">)</span>
<span class="c1"># qg.plot(style=&#39;wireframe&#39;)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Checking faces:   0%|          | 0/1551649 [00:00&lt;?, ?it/s]
Checking faces:   1%|1         | 19477/1551649 [00:00&lt;00:07, 194759.97it/s]
Checking faces:   3%|2         | 46099/1551649 [00:00&lt;00:06, 236789.87it/s]
Checking faces:   4%|4         | 69779/1551649 [00:00&lt;00:07, 206953.12it/s]
Checking faces:   6%|5         | 90864/1551649 [00:00&lt;00:08, 177290.15it/s]
Checking faces:   7%|7         | 109239/1551649 [00:00&lt;00:09, 159820.61it/s]
Checking faces:   9%|8         | 132313/1551649 [00:00&lt;00:07, 179715.74it/s]
Checking faces:  10%|9         | 151042/1551649 [00:00&lt;00:08, 172391.66it/s]
Checking faces:  11%|#         | 168783/1551649 [00:01&lt;00:09, 142697.84it/s]
Checking faces:  12%|#2        | 192441/1551649 [00:01&lt;00:08, 165854.11it/s]
Checking faces:  14%|#3        | 210329/1551649 [00:01&lt;00:08, 154167.54it/s]
Checking faces:  15%|#4        | 226927/1551649 [00:01&lt;00:08, 157156.66it/s]
Checking faces:  16%|#5        | 243374/1551649 [00:01&lt;00:09, 144158.48it/s]
Checking faces:  17%|#6        | 258417/1551649 [00:01&lt;00:08, 143820.79it/s]
Checking faces:  18%|#7        | 273232/1551649 [00:01&lt;00:09, 137104.33it/s]
Checking faces:  19%|#8        | 287251/1551649 [00:01&lt;00:09, 128468.88it/s]
Checking faces:  19%|#9        | 302076/1551649 [00:01&lt;00:09, 133604.33it/s]
Checking faces:  20%|##        | 315693/1551649 [00:02&lt;00:10, 122616.07it/s]
Checking faces:  23%|##3       | 363216/1551649 [00:02&lt;00:05, 214610.12it/s]
Checking faces:  25%|##4       | 386275/1551649 [00:02&lt;00:06, 168540.53it/s]
Checking faces:  26%|##6       | 405704/1551649 [00:02&lt;00:06, 168423.56it/s]
Checking faces:  27%|##7       | 424347/1551649 [00:02&lt;00:07, 160358.16it/s]
Checking faces:  28%|##8       | 441629/1551649 [00:02&lt;00:07, 152182.47it/s]
Checking faces:  30%|##9       | 460836/1551649 [00:02&lt;00:06, 161896.94it/s]
Checking faces:  31%|###       | 478400/1551649 [00:02&lt;00:06, 165441.53it/s]
Checking faces:  32%|###2      | 497238/1551649 [00:03&lt;00:06, 171617.76it/s]
Checking faces:  33%|###3      | 514914/1551649 [00:03&lt;00:07, 138764.52it/s]
Checking faces:  34%|###4      | 530095/1551649 [00:03&lt;00:07, 128348.30it/s]
Checking faces:  35%|###5      | 543889/1551649 [00:03&lt;00:08, 118459.29it/s]
Checking faces:  36%|###5      | 556435/1551649 [00:03&lt;00:08, 111935.24it/s]
Checking faces:  37%|###6      | 568090/1551649 [00:03&lt;00:09, 106943.72it/s]
Checking faces:  37%|###7      | 579072/1551649 [00:03&lt;00:09, 104563.13it/s]
Checking faces:  38%|###8      | 593407/1551649 [00:04&lt;00:08, 114368.67it/s]
Checking faces:  40%|###9      | 613962/1551649 [00:04&lt;00:06, 138562.97it/s]
Checking faces:  40%|####      | 628345/1551649 [00:04&lt;00:06, 132690.19it/s]
Checking faces:  41%|####1     | 643459/1551649 [00:04&lt;00:06, 137692.25it/s]
Checking faces:  43%|####2     | 664355/1551649 [00:04&lt;00:05, 157589.85it/s]
Checking faces:  45%|####4     | 695958/1551649 [00:04&lt;00:04, 202769.92it/s]
Checking faces:  47%|####7     | 730930/1551649 [00:04&lt;00:03, 245302.31it/s]
Checking faces:  49%|####9     | 766805/1551649 [00:04&lt;00:02, 278486.34it/s]
Checking faces:  51%|#####1    | 795091/1551649 [00:04&lt;00:02, 256176.73it/s]
Checking faces:  53%|#####2    | 821357/1551649 [00:05&lt;00:03, 204433.28it/s]
Checking faces:  54%|#####4    | 843802/1551649 [00:05&lt;00:03, 189428.01it/s]
Checking faces:  56%|#####6    | 869188/1551649 [00:05&lt;00:03, 204667.28it/s]
Checking faces:  57%|#####7    | 891083/1551649 [00:05&lt;00:03, 168283.26it/s]
Checking faces:  59%|#####8    | 909794/1551649 [00:05&lt;00:03, 168850.97it/s]
Checking faces:  60%|#####9    | 928011/1551649 [00:05&lt;00:04, 146530.21it/s]
Checking faces:  61%|######    | 943929/1551649 [00:05&lt;00:04, 149231.78it/s]
Checking faces:  62%|######1   | 959825/1551649 [00:06&lt;00:04, 143313.77it/s]
Checking faces:  63%|######2   | 974807/1551649 [00:06&lt;00:04, 139186.39it/s]
Checking faces:  64%|######3   | 990636/1551649 [00:06&lt;00:03, 144031.01it/s]
Checking faces:  65%|######5   | 1009548/1551649 [00:06&lt;00:03, 156022.18it/s]
Checking faces:  66%|######6   | 1028554/1551649 [00:06&lt;00:03, 165390.88it/s]
Checking faces:  68%|######8   | 1061138/1551649 [00:06&lt;00:02, 210681.45it/s]
Checking faces:  70%|#######   | 1092618/1551649 [00:06&lt;00:01, 240596.07it/s]
Checking faces:  72%|#######2  | 1117194/1551649 [00:06&lt;00:02, 174967.15it/s]
Checking faces:  73%|#######3  | 1137577/1551649 [00:07&lt;00:02, 144169.71it/s]
Checking faces:  74%|#######4  | 1154724/1551649 [00:07&lt;00:03, 128807.20it/s]
Checking faces:  75%|#######5  | 1169606/1551649 [00:07&lt;00:03, 120158.06it/s]
Checking faces:  76%|#######6  | 1182959/1551649 [00:07&lt;00:03, 115786.55it/s]
Checking faces:  77%|#######7  | 1195395/1551649 [00:07&lt;00:03, 110993.90it/s]
Checking faces:  78%|#######7  | 1207027/1551649 [00:07&lt;00:03, 109556.93it/s]
Checking faces:  79%|#######8  | 1218891/1551649 [00:07&lt;00:02, 111743.41it/s]
Checking faces:  80%|#######9  | 1239397/1551649 [00:07&lt;00:02, 135634.03it/s]
Checking faces:  81%|########  | 1253575/1551649 [00:08&lt;00:02, 126353.71it/s]
Checking faces:  82%|########1 | 1269498/1551649 [00:08&lt;00:02, 134912.92it/s]
Checking faces:  83%|########3 | 1291228/1551649 [00:08&lt;00:01, 157250.11it/s]
Checking faces:  84%|########4 | 1307529/1551649 [00:08&lt;00:01, 152923.43it/s]
Checking faces:  86%|########5 | 1327318/1551649 [00:08&lt;00:01, 165397.37it/s]
Checking faces:  87%|########6 | 1344248/1551649 [00:08&lt;00:01, 159559.33it/s]
Checking faces:  88%|########7 | 1364542/1551649 [00:08&lt;00:01, 171694.80it/s]
Checking faces:  89%|########9 | 1382008/1551649 [00:08&lt;00:01, 164243.86it/s]
Checking faces:  91%|######### | 1409022/1551649 [00:08&lt;00:00, 193864.73it/s]
Checking faces:  93%|#########2| 1442550/1551649 [00:09&lt;00:00, 234237.90it/s]
Checking faces:  95%|#########4| 1466540/1551649 [00:09&lt;00:00, 235871.80it/s]
Checking faces:  96%|#########6| 1491550/1551649 [00:09&lt;00:00, 240032.16it/s]
Checking faces:  98%|#########8| 1525777/1551649 [00:09&lt;00:00, 270175.00it/s]
Checking faces: 100%|##########| 1551649/1551649 [00:09&lt;00:00, 165301.70it/s]

(&lt;FieldAssociation.CELL: 1&gt;, pyvista_ndarray([3.65619235, 3.65619509, 3.656196  , ..., 0.05712822,
                 0.05712822, 0.05712799]))
</pre></div>
</div>
<section id="segment-mesh-and-visualize">
<h2>Segment mesh and visualize<a class="headerlink" href="#segment-mesh-and-visualize" title="Permalink to this heading">ÔÉÅ</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fstem</span> <span class="o">=</span> <span class="s1">&#39;xcell</span><span class="si">%d</span><span class="s1">-</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">mindepth</span><span class="p">,</span> <span class="n">maxdepth</span><span class="p">)</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">inside</span><span class="o">.</span><span class="n">threshold</span><span class="p">(</span>
    <span class="n">value</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">scalars</span><span class="o">=</span><span class="s1">&#39;SelectedPoints&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">extract_largest</span><span class="p">()</span>
<span class="n">result</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fstem</span><span class="o">+</span><span class="s1">&#39;.vtk&#39;</span><span class="p">)</span>

<span class="c1"># obj = result.extract_surface()</span>
<span class="c1"># pv.save_meshio(fstem+&#39;.obj&#39;, obj)</span>
<span class="n">pv</span><span class="o">.</span><span class="n">save_meshio</span><span class="p">(</span><span class="s1">&#39;quads.obj&#39;</span><span class="p">,</span> <span class="n">qmesh</span><span class="p">)</span>


<span class="c1"># result = pv.read(&#39;xcell2-9.vtk&#39;)</span>

<span class="c1"># thm = pv.themes.DarkTheme()</span>
<span class="c1"># thm.background = pv.Color(xcell.colors.DARK, opacity=0)</span>
<span class="c1"># offwhite = pv.Color(xcell.colors.OFFWHITE, opacity=1.)</span>


<span class="c1"># pv.set_plot_theme(thm)</span>

<span class="c1"># p = pv.Plotter(off_screen=True)</span>
<span class="c1"># p.add_mesh(stl, color=&#39;blue&#39;, opacity=0.75)</span>

<span class="c1"># viewup = [0.2, -1., 0.]</span>

<span class="c1"># p.add_mesh(result, show_edges=False, color=offwhite)</span>

<span class="c1"># p.enable_eye_dome_lighting()</span>

<span class="c1"># p.show(auto_close=False)</span>

<span class="c1"># # path = p.generate_orbital_path(factor=1.5, n_points=144, viewup=viewup, shift=-0.2)</span>
<span class="c1"># path = p.generate_orbital_path(</span>
<span class="c1">#     factor=1.5, n_points=32, viewup=viewup, shift=-0.2)</span>

<span class="c1"># p.open_movie(&quot;orbit.mp4&quot;)</span>

<span class="c1"># p.orbit_on_path(path, write_frames=True, viewup=viewup,</span>
<span class="c1">#                 step=0.1, progress_bar=True)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 4 minutes  14.605 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-geometry-plot-brainstyle-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/d11f82c1ef1d6f374f6e8d40f3aa5703/plot_brainStyle.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_brainStyle.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1a9010e39d2014ce1530eef0e92d79ed/plot_brainStyle.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_brainStyle.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="plot_xcellLogo.html" class="btn btn-neutral float-left" title="Logo" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, CBC Girard.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>